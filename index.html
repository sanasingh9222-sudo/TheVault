<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>The Vault</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        :root { --bg: #000; --card: #1c1c1e; --accent: #0A84FF; --text: #fff; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); padding: 20px; margin: 0; }
        .category-section { margin-bottom: 30px; }
        .category-title { font-size: 13px; color: #8e8e93; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; font-weight: 600; border-bottom: 1px solid #2c2c2e; padding-bottom: 5px; }
        .tile-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)); gap: 12px; }
        .tile { background: var(--card); border-radius: 14px; text-decoration: none; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 1 / 1; border: 1px solid #2c2c2e; position: relative; }
        .tile-icon { font-size: 18px; font-weight: 700; color: var(--accent); background: #2c2c2e; width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; border-radius: 10px; margin-bottom: 6px; }
        .tile-name { font-size: 11px; text-align: center; width: 90%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        
        /* The "Add" Form at the bottom */
        .admin-panel { background: #1c1c1e; padding: 20px; border-radius: 15px; margin-top: 50px; border: 1px solid #333; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: none; background: #2c2c2e; color: white; font-size: 14px; box-sizing: border-box; }
        button { background: var(--accent); font-weight: bold; }
    </style>
</head>
<body>
    <h1>The Vault</h1>
    <div id="vault-content">Loading live database...</div>

    <div class="admin-panel">
        <h2 style="font-size: 16px; margin-top: 0;">Add New Bookmark</h2>
        <input type="text" id="siteName" placeholder="Site Name (e.g. GatesNotes)">
        <input type="text" id="siteUrl" placeholder="URL (https://...)">
        <select id="siteCat">
            <option value="Source">Source</option>
            <option value="Read">Read</option>
            <option value="To Be Read">To Be Read</option>
        </select>
        <button onclick="addBookmark()">Add to Vault</button>
    </div>

    <script>
        // PASTE YOUR FIREBASE CONFIG HERE
        const firebaseConfig = {
              apiKey: "AIzaSyAci66jWCRg_X6FfCWz8FYNKtRqWM--O4s",
    authDomain: "thevault-fb14e.firebaseapp.com",
    projectId: "thevault-fb14e",
    storageBucket: "thevault-fb14e.firebasestorage.app",
    messagingSenderId: "181855705164",
    appId: "1:181855705164:web:2508720fe56
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Listen for data changes in real-time
        db.collection("bookmarks").onSnapshot((snapshot) => {
            const categories = {};
            snapshot.forEach(doc => {
                const data = doc.data();
                if (!categories[data.category]) categories[data.category] = [];
                categories[data.category].push({ id: doc.id, ...data });
            });

            const content = document.getElementById('vault-content');
            content.innerHTML = '';
            Object.keys(categories).sort().forEach(cat => {
                let html = `<div class="category-section"><div class="category-title">${cat}</div><div class="tile-grid">`;
                categories[cat].forEach(item => {
                    const initials = item.name.substring(0,2).toUpperCase();
                    html += `<a href="${item.url}" class="tile" target="_blank">
                                <div class="tile-icon">${initials}</div>
                                <div class="tile-name">${item.name}</div>
                             </a>`;
                });
                html += `</div></div>`;
                content.innerHTML += html;
            });
        });

        async function addBookmark() {
            const name = document.getElementById('siteName').value;
            const url = document.getElementById('siteUrl').value;
            const category = document.getElementById('siteCat').value;

            if (name && url) {
                await db.collection("bookmarks").add({ name, url, category, timestamp: Date.now() });
                document.getElementById('siteName').value = '';
                document.getElementById('siteUrl').value = '';
                alert("Saved to Vault!");
            }
        }
    </script>
</body>
</html>
