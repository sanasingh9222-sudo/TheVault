<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>The Vault</title>
    <style>
        :root { --bg: #000; --card: #1c1c1e; --accent: #0A84FF; --text: #fff; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        
        h1 { font-size: 24px; font-weight: 700; margin: 20px 0 30px 0; letter-spacing: -0.5px; }

        .category-section { margin-bottom: 30px; }
        .category-title { 
            font-size: 13px; color: #8e8e93; text-transform: uppercase; 
            letter-spacing: 1px; margin-bottom: 15px; font-weight: 600; 
        }

        .tile-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }

        .tile { 
            background: var(--card); border-radius: 16px; text-decoration: none; 
            color: white; display: flex; flex-direction: column; align-items: center; 
            justify-content: center; aspect-ratio: 1 / 1; border: 1px solid #2c2c2e;
        }
        
        .tile-icon { 
            font-size: 18px; font-weight: 700; color: var(--accent); 
            background: #2c2c2e; width: 42px; height: 42px; 
            display: flex; align-items: center; justify-content: center; 
            border-radius: 10px; margin-bottom: 8px; 
        }

        .tile-name { font-size: 11px; font-weight: 500; text-align: center; width: 85%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    </style>
</head>
<body>
    <h1>The Vault</h1>
    <div id="vault-content">Loading...</div>

    <script>
        const sheetUrl = 'YOUR_CSV_URL_HERE'; // <--- PASTE YOUR CSV LINK HERE

        async function loadVault() {
            try {
                const response = await fetch(sheetUrl);
                const text = await response.text();
                
                // Cleans up the lines and skips the header
                const lines = text.split(/\r?\n/).slice(1).filter(l => l.trim() !== "");
                
                const categories = {};

                lines.forEach(line => {
                    // This logic splits by comma but ignores commas inside quotes
                    const cols = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    
                    if (cols.length >= 2) {
                        const cleanName = cols[0].replace(/["']/g, "").trim();
                        const cleanUrl = cols[1].replace(/["']/g, "").trim();
                        const cleanCat = (cols[2] || "Other").replace(/["']/g, "").trim();
                        
                        // Ignore rows that seem to be spreadsheet metadata (like "0" or "arial")
                        if (cleanName.length > 2 || cleanUrl.includes("http")) {
                            if (!categories[cleanCat]) categories[cleanCat] = [];
                            categories[cleanCat].push({ name: cleanName, url: cleanUrl });
                        }
                    }
                });

                const content = document.getElementById('vault-content');
                content.innerHTML = '';

                // Sort categories so 'Source' stays at top if you want
                for (const [title, links] of Object.entries(categories)) {
                    let html = `<div class="category-section">
                        <div class="category-title">${title}</div>
                        <div class="tile-grid">`;
                    
                    links.forEach(link => {
                        const initials = link.name.substring(0, 2).toUpperCase();
                        html += `
                            <a href="${link.url}" class="tile" target="_blank">
                                <div class="tile-icon">${initials}</div>
                                <div class="tile-name">${link.name}</div>
                            </a>`;
                    });
                    html += `</div></div>`;
                    content.innerHTML += html;
                }
            } catch (err) { console.error(err); }
        }
        loadVault();
    </script>
</body>
</html>
